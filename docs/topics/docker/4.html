<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>docker-compose.yml命令 | YupaiTS的博客</title>
    <meta name="description" content="个人技术博客">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.4568b041.css" as="style"><link rel="preload" href="/assets/js/app.a98ee14a.js" as="script"><link rel="preload" href="/assets/js/38.4607a034.js" as="script"><link rel="prefetch" href="/assets/js/24.20c893ac.js"><link rel="prefetch" href="/assets/js/2.cda51ec0.js"><link rel="prefetch" href="/assets/js/3.988cdff6.js"><link rel="prefetch" href="/assets/js/4.9b90be30.js"><link rel="prefetch" href="/assets/js/5.81f5ddb9.js"><link rel="prefetch" href="/assets/js/6.db8c83e3.js"><link rel="prefetch" href="/assets/js/7.d7d78d24.js"><link rel="prefetch" href="/assets/js/8.5c70aa85.js"><link rel="prefetch" href="/assets/js/9.68891a98.js"><link rel="prefetch" href="/assets/js/10.911c985c.js"><link rel="prefetch" href="/assets/js/11.4fbda7d9.js"><link rel="prefetch" href="/assets/js/12.ae7f889d.js"><link rel="prefetch" href="/assets/js/13.5ca5825f.js"><link rel="prefetch" href="/assets/js/14.edc23544.js"><link rel="prefetch" href="/assets/js/15.01d1df0b.js"><link rel="prefetch" href="/assets/js/16.677b666f.js"><link rel="prefetch" href="/assets/js/17.0ab1af8d.js"><link rel="prefetch" href="/assets/js/18.015d176b.js"><link rel="prefetch" href="/assets/js/19.5c01945c.js"><link rel="prefetch" href="/assets/js/20.1e9c831a.js"><link rel="prefetch" href="/assets/js/21.a59403f9.js"><link rel="prefetch" href="/assets/js/22.3e425e5b.js"><link rel="prefetch" href="/assets/js/23.55db1404.js"><link rel="prefetch" href="/assets/js/25.b18d1a7a.js"><link rel="prefetch" href="/assets/js/26.075d1281.js"><link rel="prefetch" href="/assets/js/27.af3dd1c3.js"><link rel="prefetch" href="/assets/js/28.b4870a44.js"><link rel="prefetch" href="/assets/js/29.35abbac0.js"><link rel="prefetch" href="/assets/js/30.f1a391cb.js"><link rel="prefetch" href="/assets/js/31.acbbceee.js"><link rel="prefetch" href="/assets/js/32.1845f5a3.js"><link rel="prefetch" href="/assets/js/33.5cfe5e20.js"><link rel="prefetch" href="/assets/js/34.3698065a.js"><link rel="prefetch" href="/assets/js/35.da519351.js"><link rel="prefetch" href="/assets/js/36.def103cc.js"><link rel="prefetch" href="/assets/js/37.efbf2bdc.js"><link rel="prefetch" href="/assets/js/39.c7be3454.js"><link rel="prefetch" href="/assets/js/40.2f61a8a6.js"><link rel="prefetch" href="/assets/js/41.f1914e27.js"><link rel="prefetch" href="/assets/js/42.f3820d42.js"><link rel="prefetch" href="/assets/js/43.9085fc7e.js"><link rel="prefetch" href="/assets/js/44.4652d519.js"><link rel="prefetch" href="/assets/js/45.2ce37979.js"><link rel="prefetch" href="/assets/js/46.e71e1db8.js"><link rel="prefetch" href="/assets/js/47.6f141096.js"><link rel="prefetch" href="/assets/js/48.e8d962e0.js"><link rel="prefetch" href="/assets/js/49.83abc5df.js"><link rel="prefetch" href="/assets/js/50.ab808cd9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4568b041.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">YupaiTS的博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/5.html" class="nav-link">String.format的用法</a></li><li class="dropdown-item"><!----> <a href="/java/4.html" class="nav-link">Java集合杂谈</a></li><li class="dropdown-item"><!----> <a href="/java/3.html" class="nav-link">Java运算符instanceof的用法</a></li><li class="dropdown-item"><!----> <a href="/java/2.html" class="nav-link">Java枚举类实例</a></li><li class="dropdown-item"><!----> <a href="/java/1.html" class="nav-link">Java递归的实践</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">系列专题</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/topics/spring-cloud/" class="nav-link">基于Spring Cloud快速搭建微服务</a></li><li class="dropdown-item"><!----> <a href="/topics/docker/" class="nav-link router-link-active">Docker入门攻略</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">运维部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ops-deploy/8.html" class="nav-link">GitLab-CI环境搭建与SpringBoot项目CI配置总结</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/7.html" class="nav-link">使用Gitee+Jenkins+Docker完成前后端分离项目的CI/CD</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/6.html" class="nav-link">使用GitHub和Jenkins自动构建并部署静态页面</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/5.html" class="nav-link">通过开启swap分区解决小内存阿里云服务器的运行瓶颈</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/4.html" class="nav-link">Linux常用指令</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/3.html" class="nav-link">RabbitMQ安装部署及常见问题</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/2.html" class="nav-link">阿里云服务器环境搭建</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/1.html" class="nav-link">阿里云Linux服务器格式化和挂载数据盘</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">实用工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/5.html" class="nav-link">Linux下安装Confluence</a></li><li class="dropdown-item"><!----> <a href="/tools/4.html" class="nav-link">Markdown语法</a></li><li class="dropdown-item"><!----> <a href="/tools/3.html" class="nav-link">cron语法简单总结</a></li><li class="dropdown-item"><!----> <a href="/tools/2.html" class="nav-link">使用hexo快速搭建个人博客</a></li><li class="dropdown-item"><!----> <a href="/tools/1.html" class="nav-link">搭建 GitLab 私有代码托管</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">实战总结</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/in-action/10.html" class="nav-link">常见异常解决方案总结</a></li><li class="dropdown-item"><!----> <a href="/in-action/9.html" class="nav-link">开发实战总结</a></li><li class="dropdown-item"><!----> <a href="/in-action/8.html" class="nav-link">GitLab使用手册</a></li><li class="dropdown-item"><!----> <a href="/in-action/7.html" class="nav-link">SpringBoot和Vue单页面前后端分离项目的整合与构建</a></li><li class="dropdown-item"><!----> <a href="/in-action/6.html" class="nav-link">Git分支管理</a></li><li class="dropdown-item"><!----> <a href="/in-action/5.html" class="nav-link">从Ultimate-Spider全方位解析数据采集系统的基本知识</a></li><li class="dropdown-item"><!----> <a href="/in-action/4.html" class="nav-link">开源项目License的介绍</a></li><li class="dropdown-item"><!----> <a href="/in-action/3.html" class="nav-link">Todo-Tomato技术解读</a></li><li class="dropdown-item"><!----> <a href="/in-action/2.html" class="nav-link">微信公众号管理平台的实现</a></li><li class="dropdown-item"><!----> <a href="/in-action/1.html" class="nav-link">weixin-java-tools微信JavaSDK开发工具包</a></li></ul></div></div><div class="nav-item"><a href="/books.html" class="nav-link">阅读书单</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/YupaiTS/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/5.html" class="nav-link">String.format的用法</a></li><li class="dropdown-item"><!----> <a href="/java/4.html" class="nav-link">Java集合杂谈</a></li><li class="dropdown-item"><!----> <a href="/java/3.html" class="nav-link">Java运算符instanceof的用法</a></li><li class="dropdown-item"><!----> <a href="/java/2.html" class="nav-link">Java枚举类实例</a></li><li class="dropdown-item"><!----> <a href="/java/1.html" class="nav-link">Java递归的实践</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">系列专题</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/topics/spring-cloud/" class="nav-link">基于Spring Cloud快速搭建微服务</a></li><li class="dropdown-item"><!----> <a href="/topics/docker/" class="nav-link router-link-active">Docker入门攻略</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">运维部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ops-deploy/8.html" class="nav-link">GitLab-CI环境搭建与SpringBoot项目CI配置总结</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/7.html" class="nav-link">使用Gitee+Jenkins+Docker完成前后端分离项目的CI/CD</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/6.html" class="nav-link">使用GitHub和Jenkins自动构建并部署静态页面</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/5.html" class="nav-link">通过开启swap分区解决小内存阿里云服务器的运行瓶颈</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/4.html" class="nav-link">Linux常用指令</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/3.html" class="nav-link">RabbitMQ安装部署及常见问题</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/2.html" class="nav-link">阿里云服务器环境搭建</a></li><li class="dropdown-item"><!----> <a href="/ops-deploy/1.html" class="nav-link">阿里云Linux服务器格式化和挂载数据盘</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">实用工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/5.html" class="nav-link">Linux下安装Confluence</a></li><li class="dropdown-item"><!----> <a href="/tools/4.html" class="nav-link">Markdown语法</a></li><li class="dropdown-item"><!----> <a href="/tools/3.html" class="nav-link">cron语法简单总结</a></li><li class="dropdown-item"><!----> <a href="/tools/2.html" class="nav-link">使用hexo快速搭建个人博客</a></li><li class="dropdown-item"><!----> <a href="/tools/1.html" class="nav-link">搭建 GitLab 私有代码托管</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">实战总结</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/in-action/10.html" class="nav-link">常见异常解决方案总结</a></li><li class="dropdown-item"><!----> <a href="/in-action/9.html" class="nav-link">开发实战总结</a></li><li class="dropdown-item"><!----> <a href="/in-action/8.html" class="nav-link">GitLab使用手册</a></li><li class="dropdown-item"><!----> <a href="/in-action/7.html" class="nav-link">SpringBoot和Vue单页面前后端分离项目的整合与构建</a></li><li class="dropdown-item"><!----> <a href="/in-action/6.html" class="nav-link">Git分支管理</a></li><li class="dropdown-item"><!----> <a href="/in-action/5.html" class="nav-link">从Ultimate-Spider全方位解析数据采集系统的基本知识</a></li><li class="dropdown-item"><!----> <a href="/in-action/4.html" class="nav-link">开源项目License的介绍</a></li><li class="dropdown-item"><!----> <a href="/in-action/3.html" class="nav-link">Todo-Tomato技术解读</a></li><li class="dropdown-item"><!----> <a href="/in-action/2.html" class="nav-link">微信公众号管理平台的实现</a></li><li class="dropdown-item"><!----> <a href="/in-action/1.html" class="nav-link">weixin-java-tools微信JavaSDK开发工具包</a></li></ul></div></div><div class="nav-item"><a href="/books.html" class="nav-link">阅读书单</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/YupaiTS/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Docker入门攻略</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/topics/docker/" class="sidebar-link">安装Docker</a></li><li><a href="/topics/docker/1.html" class="sidebar-link">Dockerfile指令</a></li><li><a href="/topics/docker/2.html" class="sidebar-link">Docker镜像命令</a></li><li><a href="/topics/docker/3.html" class="sidebar-link">Docker容器命令</a></li><li><a href="/topics/docker/4.html" class="active sidebar-link">docker-compose.yml命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_1-build" class="sidebar-link">(1) build</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_2-command" class="sidebar-link">(2) command</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_3-dns" class="sidebar-link">(3) dns</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_4-dns-search" class="sidebar-link">(4) dns_search</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_5-environment" class="sidebar-link">(5) environment</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_6-env-file" class="sidebar-link">(6) env_file</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_7-expose" class="sidebar-link">(7) expose</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_8-external-links" class="sidebar-link">(8) external_links</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_9-image" class="sidebar-link">(9) image</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_10-links" class="sidebar-link">(10) links</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_11-networks" class="sidebar-link">(11) networks</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_12-network-mode" class="sidebar-link">(12) network_mode</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_13-ports" class="sidebar-link">(13) ports</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_14-volumes" class="sidebar-link">(14) volumes</a></li><li class="sidebar-sub-header"><a href="/topics/docker/4.html#_15-volumes-from" class="sidebar-link">(15) volumes_from</a></li></ul></li><li><a href="/topics/docker/5.html" class="sidebar-link">docker-compose命令</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="docker-compose-yml命令"><a href="#docker-compose-yml命令" aria-hidden="true" class="header-anchor">#</a> docker-compose.yml命令</h1> <blockquote><p>引用自<a href="http://www.itmuch.com/docker/22-docker-compose-yml-commands/" target="_blank" rel="noopener noreferrer">《Docker系列教程22-docker-compose.yml常用命令》- 周立<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>docker-compose.yml是Compose的默认模板文件。该文件有多种写法，例如Version 1 file format、Version 2 file format、Version 2.1 file format、Version 3 file format等。其中，Version 1 file format将逐步被被弃用；Version 2.x及Version 3.x基本兼容，是未来的趋势。考虑到目前业界的使用情况，本节只讨论Version 2 file format下的常用命令。</p> <h2 id="_1-build"><a href="#_1-build" aria-hidden="true" class="header-anchor">#</a> (1) build</h2> <p>配置构建时的选项，Compose会利用它自动构建镜像。build的值可以是一个路径，例如：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">build</span><span class="token punctuation">:</span> ./dir
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>也可以是一个对象，用于指定Dockerfile和参数，例如：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">build</span><span class="token punctuation">:</span>
  <span class="token key atrule">context</span><span class="token punctuation">:</span> ./dir
  <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile<span class="token punctuation">-</span>alternate
  <span class="token key atrule">args</span><span class="token punctuation">:</span>
    <span class="token key atrule">buildno</span><span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_2-command"><a href="#_2-command" aria-hidden="true" class="header-anchor">#</a> (2) command</h2> <p>覆盖容器启动后默认执行的命令。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">command</span><span class="token punctuation">:</span> bundle exec thin <span class="token punctuation">-</span>p 3000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>也可以是一个list，类似于Dockerfile中的CMD指令，格式如下：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>bundle<span class="token punctuation">,</span> exec<span class="token punctuation">,</span> thin<span class="token punctuation">,</span> <span class="token punctuation">-</span>p<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3-dns"><a href="#_3-dns" aria-hidden="true" class="header-anchor">#</a> (3) dns</h2> <p>配置dns服务器。可以是一个值，也可以是一个列表。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">dns</span><span class="token punctuation">:</span> 8.8.8.8
<span class="token key atrule">dns</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> 8.8.8.8
  <span class="token punctuation">-</span> 9.9.9.9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_4-dns-search"><a href="#_4-dns-search" aria-hidden="true" class="header-anchor">#</a> (4) dns_search</h2> <p>配置DNS的搜索域名，可以是一个值，也可以是一个列表。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">dns_search</span><span class="token punctuation">:</span> example.com
<span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> dc1.example.com
  <span class="token punctuation">-</span> dc2.example.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_5-environment"><a href="#_5-environment" aria-hidden="true" class="header-anchor">#</a> (5) environment</h2> <p>环境变量设置，可使用数组或字典两种方式。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token key atrule">RACK_ENV</span><span class="token punctuation">:</span> development
  <span class="token key atrule">SHOW</span><span class="token punctuation">:</span> <span class="token string">'true'</span>
  <span class="token key atrule">SESSION_SECRET</span><span class="token punctuation">:</span>
<span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> RACK_ENV=development
  <span class="token punctuation">-</span> SHOW=true
  <span class="token punctuation">-</span> SESSION_SECRET
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_6-env-file"><a href="#_6-env-file" aria-hidden="true" class="header-anchor">#</a> (6) env_file</h2> <p>从文件中获取环境变量，可指定一个文件路径或路径列表。如果通过 <code>docker-compose -f FILE</code> 指定了Compose文件，那么env_file中的路径是Compose文件所在目录的相对路径。使用environment指定的环境变量会覆盖env_file指定的环境变量。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">env_file</span><span class="token punctuation">:</span> .env
<span class="token key atrule">env_file</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> ./common.env   <span class="token comment"># 共用</span>
  <span class="token punctuation">-</span> ./apps/web.env <span class="token comment"># web用</span>
  <span class="token punctuation">-</span> /opt/secrets.env <span class="token comment"># 密码用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_7-expose"><a href="#_7-expose" aria-hidden="true" class="header-anchor">#</a> (7) expose</h2> <p>暴露端口，只将端口暴露给连接的服务，而不暴露给宿主机。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">expose</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;3000&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;8000&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_8-external-links"><a href="#_8-external-links" aria-hidden="true" class="header-anchor">#</a> (8) external_links</h2> <p>连接到docker-compose.yml外部的容器，甚至并非Compose管理的容器，特别是提供共享或公共服务的容器。格式跟links类似，例如：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">external_links</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> redis_1
 <span class="token punctuation">-</span> project_db_1<span class="token punctuation">:</span>mysql
 <span class="token punctuation">-</span> project_db_1<span class="token punctuation">:</span>postgresql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_9-image"><a href="#_9-image" aria-hidden="true" class="header-anchor">#</a> (9) image</h2> <p>指定镜像名称或镜像id，如果本地不存在该镜像，Compose会尝试下载该镜像。</p> <p>示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">image</span><span class="token punctuation">:</span> java
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_10-links"><a href="#_10-links" aria-hidden="true" class="header-anchor">#</a> (10) links</h2> <p>连接到其他服务的容器。可以指定服务名称和服务别名（ <code>SERVICE:ALIAS</code> ），也可只指定服务名称。例如：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">web</span><span class="token punctuation">:</span>
  <span class="token key atrule">links</span><span class="token punctuation">:</span>
   <span class="token punctuation">-</span> db
   <span class="token punctuation">-</span> db<span class="token punctuation">:</span>database
   <span class="token punctuation">-</span> redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_11-networks"><a href="#_11-networks" aria-hidden="true" class="header-anchor">#</a> (11) networks</h2> <p>详见本书《Docker Compose网络设置》一节。</p> <h2 id="_12-network-mode"><a href="#_12-network-mode" aria-hidden="true" class="header-anchor">#</a> (12) network_mode</h2> <p>设置网络模式。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">&quot;bridge&quot;</span>
<span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">&quot;host&quot;</span>
<span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">&quot;none&quot;</span>
<span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">&quot;service:[service name]&quot;</span>
<span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">&quot;container:[container name/id]&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_13-ports"><a href="#_13-ports" aria-hidden="true" class="header-anchor">#</a> (13) ports</h2> <p>暴露端口信息，可使用 <code>HOST:CONTAINER</code> 的格式，也可只指定容器端口（此时宿主机将会随机选择端口），类似于 <code>docker run -p</code>。</p> <p>需要注意的是，当使用 <code>HOST:CONTAINER</code> 格式映射端口时，容器端口小于60将会得到错误的接口，因为yaml会把 <code>xx:yy</code> 的数字解析为60进制。因此，建议使用字符串的形式。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">ports</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;3000&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;3000-3005&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;8000:8000&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;9090-9091:8080-8081&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;49100:22&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:8001:8001&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:5000-5010:5000-5010&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_14-volumes"><a href="#_14-volumes" aria-hidden="true" class="header-anchor">#</a> (14) volumes</h2> <p>卷挂载路径设置。可以设置宿主机路径 （<code>HOST:CONTAINER</code>） ，也可指定访问模式 （<code>HOST:CONTAINER:ro</code>）。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token comment"># Just specify a path and let the Engine create a volume</span>
  <span class="token punctuation">-</span> /var/lib/mysql
  <span class="token comment"># Specify an absolute path mapping</span>
  <span class="token punctuation">-</span> /opt/data<span class="token punctuation">:</span>/var/lib/mysql
  <span class="token comment"># Path on the host, relative to the Compose file</span>
  <span class="token punctuation">-</span> ./cache<span class="token punctuation">:</span>/tmp/cache
  <span class="token comment"># User-relative path</span>
  <span class="token punctuation">-</span> ~/configs<span class="token punctuation">:</span>/etc/configs/<span class="token punctuation">:</span>ro
  <span class="token comment"># Named volume</span>
  <span class="token punctuation">-</span> datavolume<span class="token punctuation">:</span>/var/lib/mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_15-volumes-from"><a href="#_15-volumes-from" aria-hidden="true" class="header-anchor">#</a> (15) volumes_from</h2> <p>从另一个服务或容器挂载卷。可指定只读（ro）或读写（rw），默认是读写（rw）。示例：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">volumes_from</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> service_name
 <span class="token punctuation">-</span> service_name<span class="token punctuation">:</span>ro
 <span class="token punctuation">-</span> container<span class="token punctuation">:</span>container_name
 <span class="token punctuation">-</span> container<span class="token punctuation">:</span>container_name<span class="token punctuation">:</span>rw
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>TIPS</strong>
docker-compose.yml还有很多其他命令，比如depends_on、pid、devices等。限于篇幅，笔者仅挑选常用的命令进行讲解，其他命令不作赘述。感兴趣的读者们可参考官方文档：<a href="https://docs.docker.com/compose/compose-file/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/compose-file/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 。</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/YupaiTS/yupaits.github.io/edit/master/post/topics/docker/4.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/topics/docker/3.html" class="prev">
          Docker容器命令
        </a></span> <span class="next"><a href="/topics/docker/5.html">
          docker-compose命令
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/38.4607a034.js" defer></script><script src="/assets/js/app.a98ee14a.js" defer></script>
  </body>
</html>
